{% extends 'base.html' %}
{% load static %}

{% block title %}Visualizer - C-It{% endblock %}

{% block extra_css %}
<style>
    .code-editor {
        font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
        font-size: 14px;
        line-height: 1.6;
    }
    
    .visualization-container {
        min-height: 500px;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    }
    
    .array-element {
        transition: all 0.3s ease;
    }
    
    .array-element.highlighted {
        transform: scale(1.1);
        box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
    }
    
    .array-element.comparing {
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        color: white;
    }
    
    .array-element.swapping {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
    }
    
    .array-element.sorted {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
    }
    
    .control-panel {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
    }
    
    .step-indicator {
        transition: all 0.3s ease;
    }
    
    .step-indicator.active {
        background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        color: white;
    }
</style>
{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Header -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">Algorithm Visualizer</h1>
                    <p class="text-gray-600 mt-1">Input your C code and watch it come to life</p>
                </div>
                <div class="flex space-x-4">
                    <button id="loadExampleBtn" class="btn-secondary text-white px-4 py-2 rounded-lg text-sm font-medium">
                        <i class="fas fa-download mr-2"></i>Load Example
                    </button>
                    <button id="clearBtn" class="bg-gray-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-600 transition-colors">
                        <i class="fas fa-trash mr-2"></i>Clear
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Code Editor Panel -->
            <div class="space-y-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-code mr-2 text-blue-500"></i>
                            Code Editor
                        </h2>
                        <div class="flex space-x-2">
                            <button id="formatBtn" class="text-gray-500 hover:text-blue-600 transition-colors">
                                <i class="fas fa-magic"></i>
                            </button>
                            <button id="fullscreenBtn" class="text-gray-500 hover:text-blue-600 transition-colors">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="code-editor bg-gray-900 rounded-lg p-4 h-96 overflow-auto">
                        <textarea id="codeEditor" class="w-full h-full bg-transparent text-gray-100 resize-none outline-none" placeholder="// Enter your C code here...
#include <stdio.h>

void bubbleSort(int arr[], int n) {
    int i, j, temp;
    for (i = 0; i < n-1; i++) {
        for (j = 0; j < n-i-1; j++) {
            if (arr[j] > arr[j+1]) {
                temp = arr[j];
                arr[j] = arr[j+1];
                arr[j+1] = temp;
            }
        }
    }
}

int main() {
    int arr[] = {64, 34, 25, 12, 22, 11, 90};
    int n = sizeof(arr)/sizeof(arr[0]);
    bubbleSort(arr, n);
    return 0;
}"></textarea>
                    </div>
                    
                    <div class="mt-4 flex space-x-4">
                        <button id="visualizeBtn" class="btn-primary text-white px-6 py-3 rounded-lg font-medium flex items-center">
                            <i class="fas fa-play mr-2"></i>
                            Visualize Algorithm
                        </button>
                        <button id="stepBtn" class="bg-green-500 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-600 transition-colors flex items-center">
                            <i class="fas fa-step-forward mr-2"></i>
                            Step Through
                        </button>
                    </div>
                </div>
                
                <!-- Algorithm Information -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">
                        <i class="fas fa-info-circle mr-2 text-blue-500"></i>
                        Algorithm Information
                    </h3>
                    <div id="algorithmInfo" class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-blue-900">Algorithm Type</h4>
                                <p id="algorithmType" class="text-blue-700">-</p>
                            </div>
                            <div class="bg-green-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-green-900">Time Complexity</h4>
                                <p id="timeComplexity" class="text-green-700">-</p>
                            </div>
                            <div class="bg-purple-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-purple-900">Space Complexity</h4>
                                <p id="spaceComplexity" class="text-purple-700">-</p>
                            </div>
                            <div class="bg-orange-50 p-4 rounded-lg">
                                <h4 class="font-semibold text-orange-900">Functions Found</h4>
                                <p id="functionsFound" class="text-orange-700">-</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Visualization Panel -->
            <div class="space-y-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-bold text-gray-900">
                            <i class="fas fa-chart-bar mr-2 text-green-500"></i>
                            Visualization
                        </h2>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2">
                                <span class="text-sm text-gray-600">Speed:</span>
                                <input type="range" id="speedSlider" min="0.5" max="3" step="0.1" value="1" class="w-20">
                                <span id="speedValue" class="text-sm text-gray-600">1x</span>
                            </div>
                            <button id="pauseBtn" class="text-gray-500 hover:text-blue-600 transition-colors">
                                <i class="fas fa-pause"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="visualizationCanvas" class="visualization-container rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center">
                        <div class="text-center text-gray-500">
                            <i class="fas fa-play-circle text-4xl mb-4"></i>
                            <p class="text-lg font-medium">Click "Visualize Algorithm" to start</p>
                            <p class="text-sm">Your algorithm animation will appear here</p>
                        </div>
                    </div>
                    
                    <!-- Control Panel -->
                    <div id="controlPanel" class="control-panel mt-4 p-4 rounded-lg border hidden">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="font-semibold text-gray-900">Animation Controls</h4>
                            <div class="flex space-x-2">
                                <button id="prevStepBtn" class="bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors">
                                    <i class="fas fa-step-backward mr-1"></i>Prev
                                </button>
                                <button id="nextStepBtn" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition-colors">
                                    <i class="fas fa-step-forward mr-1"></i>Next
                                </button>
                            </div>
                        </div>
                        
                        <div class="flex items-center space-x-4">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-gray-600">Step:</span>
                                    <span id="currentStep" class="font-semibold">0</span>
                                    <span class="text-sm text-gray-600">/</span>
                                    <span id="totalSteps" class="font-semibold">0</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                    <div id="progressBar" class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="stepDescription" class="mt-4 p-3 bg-blue-50 rounded-lg">
                            <p class="text-sm text-blue-800">Ready to start visualization...</p>
                        </div>
                    </div>
                </div>
                
                <!-- Step Indicators -->
                <div id="stepIndicators" class="bg-white rounded-xl shadow-lg p-6 hidden">
                    <h3 class="text-lg font-bold text-gray-900 mb-4">
                        <i class="fas fa-list-ol mr-2 text-purple-500"></i>
                        Animation Steps
                    </h3>
                    <div id="stepList" class="grid grid-cols-5 gap-2">
                        <!-- Step indicators will be generated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Example Modal -->
<div id="exampleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-screen overflow-y-auto">
            <div class="p-6 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="text-2xl font-bold text-gray-900">Choose an Example</h3>
                    <button id="closeModalBtn" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Sorting Examples -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-sort mr-2 text-blue-500"></i>
                            Sorting Algorithms
                        </h4>
                        <div class="space-y-3">
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-blue-50 transition-colors" data-type="bubble_sort">
                                <div class="font-medium text-gray-900">Bubble Sort</div>
                                <div class="text-sm text-gray-600">Simple sorting with O(n²) complexity</div>
                            </button>
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-blue-50 transition-colors" data-type="quick_sort">
                                <div class="font-medium text-gray-900">Quick Sort</div>
                                <div class="text-sm text-gray-600">Efficient divide-and-conquer sorting</div>
                            </button>
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-blue-50 transition-colors" data-type="merge_sort">
                                <div class="font-medium text-gray-900">Merge Sort</div>
                                <div class="text-sm text-gray-600">Stable sorting with O(n log n) complexity</div>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Searching Examples -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-900 mb-4">
                            <i class="fas fa-search mr-2 text-green-500"></i>
                            Searching Algorithms
                        </h4>
                        <div class="space-y-3">
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-green-50 transition-colors" data-type="binary_search">
                                <div class="font-medium text-gray-900">Binary Search</div>
                                <div class="text-sm text-gray-600">Fast search in sorted arrays</div>
                            </button>
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-green-50 transition-colors" data-type="linear_search">
                                <div class="font-medium text-gray-900">Linear Search</div>
                                <div class="text-sm text-gray-600">Simple sequential search</div>
                            </button>
                        </div>
                        
                        <h4 class="text-lg font-semibold text-gray-900 mb-4 mt-6">
                            <i class="fas fa-project-diagram mr-2 text-purple-500"></i>
                            Data Structures
                        </h4>
                        <div class="space-y-3">
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-purple-50 transition-colors" data-type="linked_list">
                                <div class="font-medium text-gray-900">Linked List</div>
                                <div class="text-sm text-gray-600">Dynamic data structure</div>
                            </button>
                            <button class="example-btn w-full text-left p-3 rounded-lg border hover:bg-purple-50 transition-colors" data-type="stack">
                                <div class="font-medium text-gray-900">Stack</div>
                                <div class="text-sm text-gray-600">LIFO data structure</div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/visualizer.js' %}" defer></script>
{% endblock %}